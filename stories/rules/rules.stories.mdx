import { Meta, Story, Source, Canvas } from '@storybook/addon-docs';
import * as stories from './rules.stories.tsx';
import { Component } from 'react';

<Meta title="Domino/Rules" component={Component} />

# Rules of dominos

## Trigger
Triggers are the basic form of dominos they are read and write enabled. 
When changed they will trigger a domino effect and will cascade changes to dependent domnions.

<Canvas>
    <Story story={stories.Trigger} />
</Canvas>

## Domino
Dominos are derived from triggers, they exhibit the domino effect and will cascade changes to dependent dominos.

<Canvas>
    <Story story={stories.Domino} />
</Canvas>


## One domino per component
In order to support asynchronous behaviors within the react rules of hooks, only one domino can be used per component.
If you need more than one, consider splitting the component or combining dominos.

### Splitting Components

<Canvas>
    <Story story={stories.SplittingComponents} />
</Canvas>

### Combining Dominos

<Canvas>
    <Story story={stories.CombiningDominos} />
</Canvas>

## Select only what you need
When dealing with complex objects dominos can cause excessive rendering. 
To resolve rendering problems you can split using basic dominos and memoize components.

### Splitting Dominos

<Canvas>
    <Story story={stories.SplittingDominos} />
</Canvas>

This works with async dominos too! 
Just keep in mind async operations will still be performed if they depend directly on changed values.

### Splitting Async Dominos

<Canvas>
    <Story story={stories.SplittingAsyncDominos} />
</Canvas>

## Caching in Dominos

You can cache data in your dominos for expensive operations.
Just keep in mind to expire data, that may get stale.

<Canvas>
    <Story story={stories.Caching} />
</Canvas>

### Multiple values
You can use a single domino for multiple values either by providing a context, or custom stores.

### Using Context with Dominos

You can pass primitives or immutable's (the package) to access contextual values. This allows you to use local state to pick an instance

<Canvas>
    <Story story={stories.Context} />
</Canvas>

### Custom Stores for Dominos

You can pass the stores via context to prevent prop drilling.
To create a store local to your components use useLocalStore, to avoid memory leaks.

<Canvas>
    <Story story={stories.CustomStores} />
</Canvas>



